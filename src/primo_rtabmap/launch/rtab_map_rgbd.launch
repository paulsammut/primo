<?xml version="1.0"?>
<launch>

    <!-- 
         This launch file uses the pointcloud generated by stereo_image_proc of 
         the stereo1 pointcloud. 
    -->
    <arg name="odom_topic"              default="odom"/>
    <arg name="rtab_args"               default=""/>
    <arg name="stereo_cam"              default="/stereo2"/>
    
    <node ns="$(arg stereo_cam)" pkg="nodelet" type="nodelet" name="disparity2depth" 
        args="standalone rtabmap_ros/disparity_to_depth"/>

    <arg name="rgb_topic"               value="$(arg stereo_cam)/left/image_rect_color"/>
    <arg name="depth_registered_topic"  value="$(arg stereo_cam)/depth"/>
    <arg name="camera_info_topic"       value="$(arg stereo_cam)/left/camera_info"/>
    <arg name="frame_id"                value="base_link"/>
    <arg name="compressed"              value="false"/>


    <node name="rtabmap" pkg="rtabmap_ros" type="rtabmap" output="screen" args="$(arg rtab_args)">
        <param name="RBGD/Enabled"          type="string"   value="true"/>
        
		<param name="subscribe_stereo"      type="bool"     value="false"/>
		<param name="subscribe_depth"       type="bool"     value="true"/>
        <param name="subscribe_scan_cloud"  type="bool"     value="false"/>
		<param name="stereo_approx_sync"    type="bool"     value="true"/>

        <param name="frame_id"              type="string"   value="base_link"/>

        <remap from="odom"              to="$(arg odom_topic)"/>
        <remap from="rgb/image"         to="$(arg stereo_cam)/left/image_rect_color"/>
        <remap from="depth/image"       to="$(arg stereo_cam)/depth"/>
        <remap from="rgb/camera_info"   to="$(arg stereo_cam)/left/camera_info"/>

        <param name="queue_size"                type="int"      value="30"/>

	  </node>
</launch>
