<?xml version="1.0" encoding="UTF-8"?>
<launch>

    <arg name="stereo_real" default="true"/>
    <arg name="filter"      default="true"/>

    <rosparam file="$(find primo_stereo)/config/stereo.yaml" command="load"/>

    <node if="$(arg stereo_real)" ns="stereo1" pkg="uvc_camera" type="tara_node" name="uvc_camera" output="screen" required="true">
        <param name="width"         type="int"      value="640"             />
        <param name="height"        type="int"      value="480"             />
        <param name="fps"           type="int"      value="30"              />
        <param name="frame"         type="string"   value="stereo1_link"    />
        <param name="frame_id"      type="string"   value="stereo1_link"    />
        <param name="device"        type="string"   value="/dev/video1"     />
        <param name="exposureValue" type="int"      value="1"               />

        <param name="cameraLeft_info_url"   type="string"   value="package://primo_stereo/config/stereo1/left.yaml"/>
        <param name="cameraRight_info_url"  type="string"   value="package://primo_stereo/config/stereo1/right.yaml"/>
    </node>

    <!-- <node ns="/stereo1" pkg="stereo_image_proc" type="stereo_image_proc" name="stereo_image_proc"/> -->

    <group ns="/stereo1" >
        <include file="$(find primo_stereo)/launch/stereo_nodelet.launch">
            <arg name="node_space"     value="/stereo1"/>
        </include>

        <include if="$(arg filter)" file="$(find primo_stereo)/launch/filter_box.launch">
            <arg name="nodelet_manager" value="/stereo1/nodelet_manager"/>
            <arg name="points_topic"    value="/stereo1/points2"/>
            <arg name="x_pos"           value="0.5"/>
            <arg name="x_neg"           value="-0.5"/>
            <arg name="y_pos"           value="0.38"/>
            <arg name="y_neg"           value="-0.38"/>
        </include>
    </group>

    <!-- <node name="record_topics_for_verification" pkg="rosbag" type="record" args="/stereo/left/camera_info /stereo/right/camera_info /stereo/right/image_rect /stereo/left/image_rect" output="screen"/> -->

</launch>
